<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>业绩汇总</title>
    <link rel="stylesheet" href="__STATIC__/css/weui-min.css" />
    <link rel="stylesheet" href="__STATIC__/css/example.css" />
    <script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.min.js"></script>
</head>

<body style="background-color: #f2f2f2">
    <div id="pg" style="width:100%;height:100%">
        <div class="weui-flex">
            <div class="weui-flex__item" style="flex: 0 0 50%;">
                <a href="javascript:;" class="weui-btn weui-btn_default" id="showPicker" style="background-color: white;background-image: url(__STATIC__/src/下箭头.png);background-repeat: no-repeat;background-position: 90%"><img src="__STATIC__/src/日历.png" style="float: left;margin: 10px auto">2018-08</a>
            </div>
            <div class="weui-flex weui-flex__item" style="align-items: center;text-align: center;border: 1px solid rgba(0, 0, 0, 0.1);border-radius: 5px;background-color: white">
                <a href="javascript:;" class="weui-flex__item" style="color: black">本月</a>
                <a href="javascript:;" class="weui-flex__item" style="color: black">上月</a>
            </div>
        </div>
        <div class="weui-flex" style="justify-content: center;align-items: center;height: 16%;">
            <div class="box weui-flex" style="flex: 0 0 91%;height:70%; background-image: url(__STATIC__/src/background.png);border-radius: 5px;align-items: center">
                <div class="item weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: #d9d9d9;font-size: 15px;font-weight: 200">总提成（元）</h3>
                    <h1 style="color: #404040;font-size: 15px"v-text="total_bonus"></h1>
                </div>
            </div>
        </div>
        <div class="" style="height: 26%;background-color: white;width: 94%;margin-left: 3%;border-radius: 5px;">
            <div class="weui-flex" style="height: 50%;align-items: center;border-bottom: 1px #f2f2f2 solid">
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">项目业绩（元）</h3>
                    <h1 style="color: #404040;font-size: 15px" v-text="income"></h1>
                </div>
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">项目提成（元）</h3>
                    <h1 style="color: #404040;font-size: 15px"v-text="bonus"></h1>
                </div>
            </div>
            <div class="weui-flex" style="height: 50%;align-items: center;">
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">推荐次数（次）</h3>
                    <h1 style="color: #404040;font-size: 15px">1</h1>
                </div>
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">推荐提成（元）</h3>
                    <h1 style="color: #404040;font-size: 15px">99</h1>
                </div>
            </div>
        </div>
        <div class="" style="height: 18%;background-color: white;width: 94%;margin-left: 3%;border-radius: 5px;margin-top: 10px">
            <div class="weui-flex" style="height: 30%;align-items: center;border-bottom: 1px #f2f2f2 solid">
                <div class="weui-flex__item" style="justify-content: space-between;">
                    <span style="background-image: url(__STATIC__/src/时钟.png);background-repeat: no-repeat;width: 50%;background-position: 10%;padding-left: 33px">点钟率</span>
                    <span style="width: 50%;float: right;text-align: right;margin-right: 20px"v-text="point_clock/clock*100"></span>
                </div>
            </div>
            <div class="weui-flex" style="height: 70%;align-items: center;">
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">点钟（次）</h3>
                    <h1 style="color: #404040;font-size: 15px" v-text="point_clock"></h1>
                </div>
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">总钟次（次）</h3>
                    <h1 style="color: #404040;font-size: 15px" v-text="clock"></h1>
                </div>
            </div>
        </div>
        <div class="" style="height: 18%;background-color: white;width: 94%;margin-left: 3%;border-radius: 5px;margin-top: 10px">
            <div class="weui-flex" style="height: 30%;align-items: center;border-bottom: 1px #f2f2f2 solid">
                <div class="weui-flex__item" style="justify-content: space-between;">
                    <span style="background-image: url(__STATIC__/src/统计图.png);background-repeat: no-repeat;width: 50%;background-position: 10%;padding-left: 33px">售卡业绩</span>
                    <span style="width: 50%;float: right;text-align: right;margin-right: 20px" v-text = "charge_num"></span>
                </div>
            </div>
            <div class="weui-flex" style="height: 70%;align-items: center;">
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">售卡次数（次）</h3>
                    <h1 style="color: #404040;font-size: 15px"v-text = "charge_count"></h1>
                </div>
                <div class="weui-flex__item" style="margin-left: 20px">
                    <h3 style="color: gray;font-size: 15px;font-weight: 400">售卡提成（元）</h3>
                    <h1 style="color: #404040;font-size: 15px" v-text = "charge_num"></h1>
                </div>
            </div>
        </div>
        <div class="weui-footer" style="margin-top: 20px">
            <p class="weui-footer__text">查帐方式以结账时间为准</p>
        </div>
    </div>
</body>
<script type="text/javascript" src="__STATIC__/js/jweixin.js"></script>
<script type="text/javascript" src="__STATIC__/js/example.js"></script>
<script type="text/javascript" src="__STATIC__/js/weui-min.js"></script>
<script type="text/javascript" src="__STATIC__/js/zepto.js"></script>
<script type="text/javascript" src="__STATIC__/js/jquery.js"></script>
<script type="text/javascript">
    //月份选择器，以多列选择器代替
    // var threehide = 1;
    var job_number = "AKB48";
    new Vue({
        el:"#pg",
        data(){return {
            figure:[],
            income:0,
            bonus:0,
            total_bonus:0,
            clock:0,
            point_clock:0,
            charge_count:0,
            charge_num:0,
        }},
        methods:{
            get_data(begin="",end=""){
                var that=this;
                var time_limit=true;
                if(begin=="" && end=="")time_limit = false;
                that.figure = [];
                income = bonus = total_bonus = clock = point_clock = charge = charge_count = 0;
                $.post("__ROOT__/index.php/api/Serviceorder/getdetaillistfortechnician/",{
                    id:job_number
                }).done((result=>{
                    for(var i = 0;i<result.length;i++){
                        that.total_bonus += result[i]['salary'];
                        if( !time_limit || result['date']>=begin && result['date']<=end){
                            that.figure.push(result[i]);
                            that.income+=result[i]['price'];
                            that.bonus+=result[i]['salary'];
                            that.clock++;
                            if(result[i]['clocktype']=="点钟")point_clock++;
                        }

                    }
                }));
                $.post("__ROOT__/index.php/api/Rechargerecord/get",{
                    job_number:job_number
                }).done((result)=>{
                    that.charge_count = result.length;
                    for(var i =0;i<result.length;i++){
                        that.charge_num+=result[i]['charge'];
                    }
                })

                
            }
        },
        created(){
            this.get_data();
        }
    })
    $('#showPicker').on('click', function() {
        // if (threehide === 1) {
        //     $('#showPicker').css({'color':'#cc99cc','background-image':'url(上箭头.png)'});
        //     threehide = 0;
        // } else {
        //     $('#showPicker').css({'color':'black','background-image':'url(下箭头.png)'});
        //     threehide = 1;
        // }
        weui.picker([{
            label: '2015',
            value: '1'
        }, {
            label: '2016',
            value: '2'
        }, {
            label: '2017',
            value: '3'
        }, {
            label: '2018',
            value: '4'
        }, {
            label: '2019',
            value: '5'
        }, {
            label: '2020',
            value: '6'
        }, {
            label: '2021',
            value: '7'
        }, {
            label: '2022',
            value: '8'
        }, {
            label: '2023',
            value: '9'
        }, {
            label: '2024',
            value: '10'
        }, {
            label: '2025',
            value: '11'
        }], [{
            label: '1月',
            value: 'A'
        }, {
            label: '2月',
            value: 'B'
        }, {
            label: '3月',
            value: 'C'
        }, {
            label: '4月',
            value: 'D'
        }, {
            label: '5月',
            value: 'E'
        }, {
            label: '6月',
            value: 'F'
        }, {
            label: '7月',
            value: 'G'
        }, {
            label: '8月',
            value: 'H'
        }, {
            label: '9月',
            value: 'I'
        }, {
            label: '10月',
            value: 'J'
        }, {
            label: '11月',
            value: 'K'
        }, {
            label: '12月',
            value: 'L'
        }], {
            onChange: function(result) {
                console.log(result);
            },
            onConfirm: function(result) {
                console.log(result);
            }
        });
    });
</script>

</html>